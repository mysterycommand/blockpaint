(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{236:function(e,n,t){},238:function(e,n,t){e.exports=t.p+"static/media/logo.02b2068a.svg"},239:function(e,n,t){e.exports=t(565)},253:function(e,n){},254:function(e,n){},274:function(e,n){},276:function(e,n){},487:function(e,n){},557:function(e,n,t){},558:function(e,n,t){},559:function(e,n,t){},560:function(e,n,t){},561:function(e,n,t){},562:function(e,n,t){},563:function(e,n,t){},564:function(e,n,t){},565:function(e,n,t){"use strict";t.r(n);var a,i=t(1),o=t.n(i),c=t(237),r=t.n(c),l=t(89),s=t(90),u=t(92),h=t(91),v=t(93),m=t(94),d=(t(557),function(){return o.a.createElement("div",{className:"loader"},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null))}),g=(t(558),function(e){var n=e.children,t=e.disabled,a=e.onClick;return o.a.createElement("button",{className:"button",onClick:a,disabled:t},n,t&&o.a.createElement(d,null))}),f=(t(559),t(560),t(236),function(){return o.a.createElement("svg",{className:"icon paint",width:"24",height:"24",viewBox:"0 0 24 24",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M19 20H5a1 1 0 0 0 0 2h14a1 1 0 0 0 0-2zM5 18h.09l4.17-.38a2 2 0 0 0 1.21-.57l9-9a1.92 1.92 0 0 0-.07-2.71L16.66 2.6A2 2 0 0 0 14 2.53l-9 9a2 2 0 0 0-.57 1.21L4 16.91A1 1 0 0 0 5 18zM15.27 4L18 6.73l-2 1.95L13.32 6l1.95-2zm-8.9 8.91L12 7.32l2.7 2.7-5.6 5.6-3 .28.27-2.99z"}))}),p=function(){return o.a.createElement("svg",{className:"icon erase",width:"24",height:"24",viewBox:"0 0 24 24",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M19 20H5a1 1 0 0 0 0 2h14a1 1 0 0 0 0-2zm-.009-17.942h-.09l-4.17.38a2 2 0 0 0-1.21.57l-9 9a1.92 1.92 0 0 0 .07 2.71l2.74 2.74a2 2 0 0 0 2.66.07l9-9a2 2 0 0 0 .57-1.21l.43-4.17a1 1 0 0 0-1-1.09zm-10.27 14l-2.73-2.73 2-1.95 2.68 2.68-1.95 2zm8.9-8.91l-5.63 5.59-2.7-2.7 5.6-5.6 3-.28-.27 2.99z"}))};!function(e){e.Paint="paint",e.Erase="erase"}(a||(a={}));var E=function(e){var n=e.currentTool,t=e.setCurrentTool;return o.a.createElement("ul",{className:"tools"},o.a.createElement("li",null,o.a.createElement("input",{type:"radio",id:"paint",name:"tools",checked:n===a.Paint,onChange:function(){return t(a.Paint)}}),o.a.createElement("label",{htmlFor:"paint"},o.a.createElement(f,null))),o.a.createElement("li",null,o.a.createElement("input",{type:"radio",id:"erase",name:"tools",checked:n===a.Erase,onChange:function(){return t(a.Erase)}}),o.a.createElement("label",{htmlFor:"erase"},o.a.createElement(p,null))))},w=function(e){function n(){var e,t;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(h.a)(n)).call.apply(e,[this].concat(i)))).state={canvasContext:null,canvasRect:null,isPainting:!1,prevX:-1,prevY:-1},t.handleMouse=function(e){e.preventDefault();var n=0!==e.buttons;t.setState({isPainting:n,prevX:-1,prevY:-1})},t.mousePaint=function(e){e.preventDefault(),t.paint(e.clientX,e.clientY)},t.handleTouch=function(e){var n=0!==e.touches.length;t.setState({isPainting:n,prevX:-1,prevY:-1})},t.touchPaint=function(e){var n=Array.from(e.touches),a=n.reduce(function(e,n){return{clientX:e.clientX+n.clientX,clientY:e.clientY+n.clientY}},{clientX:0,clientY:0}),i=a.clientX,o=a.clientY;t.paint(i/n.length,o/n.length)},t.paint=function(e,n){var a=t.props.canvasRef.current,i=t.state,o=i.canvasContext,c=i.canvasRect,r=i.isPainting,l=i.prevX,s=i.prevY;if(a&&o&&c&&r){var u=o,h=c,v=h.x,m=h.y,d=h.width,g=h.height;u.canvas!==a&&console.warn("refs out of sync, rendering into a canvas that isn't in the DOM");var f=(e-v)*(a.width/d),p=(n-m)*(a.height/g);-1===l&&-1===s?u.beginPath():(u.moveTo(l,s),u.lineTo(f,p),u.stroke()),t.setState({prevX:f,prevY:p})}},t}return Object(v.a)(n,e),Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=this.props,t=n.canvasRef.current,a=n.fetchPainting;t&&a&&(a().then(function(n){var a=JSON.parse(n||"{}").data;if(a){var i=e.state.canvasContext;if(i){var o=i,c=new Image(t.width,t.height);c.src=a,c.onload=function(){o.drawImage(c,0,0)}}}}),this.setState({canvasContext:t.getContext("2d"),canvasRect:t.getBoundingClientRect()}))}},{key:"componentDidUpdate",value:function(){var e=this.props.currentTool,n=this.state.canvasContext;if(n){var t=n;t.strokeStyle=e===a.Paint?"black":"white",t.lineWidth=e===a.Paint?4:24,t.lineCap="round",t.lineJoin="round"}}},{key:"render",value:function(){var e=this.props.canvasRef;return o.a.createElement("canvas",{ref:e,className:"canvas",width:"1080",height:"1080",onMouseEnter:this.handleMouse,onMouseDown:this.handleMouse,onMouseMove:this.mousePaint,onMouseUp:this.handleMouse,onMouseLeave:this.handleMouse,onTouchStart:this.handleTouch,onTouchMove:this.touchPaint,onTouchEnd:this.handleTouch})}}]),n}(i.Component),S=(t(561),function(e){var n=e.canvasRef,t=e.currentTool,a=e.fetchPainting,i=e.isFetching,c=e.isSaving,r=e.person,l=e.savePainting,s=e.setCurrentTool,u=e.signOut;return o.a.createElement("div",{className:"workspace"},o.a.createElement("header",{className:"header"},o.a.createElement("h2",{className:"current-user"},"Signed in as ",r.name()||"nameless person"),o.a.createElement(g,{onClick:u},"Sign out")),o.a.createElement("div",{className:"stage"},o.a.createElement(w,{canvasRef:n,currentTool:t,fetchPainting:a}),i&&o.a.createElement("div",{className:"canvas-guard guard"},o.a.createElement(d,null))),o.a.createElement("footer",{className:"footer"},o.a.createElement(E,{currentTool:t,setCurrentTool:s}),o.a.createElement(g,{onClick:l,disabled:c},"Save")))}),P=(t(562),t(238)),C=t.n(P),b=function(e){var n=e.signIn;return o.a.createElement("header",{className:"splash"},o.a.createElement("img",{src:C.a,className:"splash-logo",alt:"logo"}),o.a.createElement(g,{onClick:n},"Sign in/up with Blockstack"))},T=(t(563),new m.AppConfig(["store_write","publish_data"])),M=new m.UserSession({appConfig:T}),k=function(e){function n(){var e,t;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(t=Object(u.a)(this,(e=Object(h.a)(n)).call.apply(e,[this].concat(c)))).canvasRef=o.a.createRef(),t.state={currentTool:a.Paint,isFetching:!1,isSaving:!1},t.signIn=function(e){e.preventDefault();var n=window.location,t=n.origin,a=n.pathname;M.redirectToSignIn("".concat(t).concat(a),"".concat(t).concat(a,"manifest.json"))},t.signOut=function(e){e.preventDefault(),M.signUserOut();var n=window.location,t=n.origin,a=n.pathname;window.location.assign("".concat(t).concat(a))},t.savePainting=function(e){e.preventDefault();var n=t.canvasRef.current;n&&(t.setState({isSaving:!0}),M.putFile("painting.json",JSON.stringify({data:n.toDataURL("image/png"),createdAt:Date.now()}),{encrypt:!1}).then(function(){t.setState({isSaving:!1})}))},t.fetchPainting=function(){var e=t.canvasRef.current;return t.setState({isFetching:!0}),(e?M.getFile("painting.json",{decrypt:!1}):Promise.resolve(JSON.stringify({}))).then(function(e){return t.setState({isFetching:!1}),e})},t.setCurrentTool=function(e){t.setState({currentTool:e})},t}return Object(v.a)(n,e),Object(s.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){M.isSignInPending()&&M.handlePendingSignIn().then(function(){var e=window.location,n=e.origin,t=e.pathname;window.location.assign("".concat(n).concat(t))})}},{key:"render",value:function(){var e=this.state,n=e.currentTool,t=e.isFetching,a=e.isSaving;return o.a.createElement("div",{className:"app"},M.isUserSignedIn()?o.a.createElement(S,{currentTool:n,canvasRef:this.canvasRef,fetchPainting:this.fetchPainting,isFetching:t,isSaving:a,person:new m.Person(M.loadUserData().profile),savePainting:this.savePainting,setCurrentTool:this.setCurrentTool,signOut:this.signOut}):o.a.createElement(b,{signIn:this.signIn}))}}]),n}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(564);r.a.render(o.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[239,1,2]]]);
//# sourceMappingURL=main.aeeb11cc.chunk.js.map